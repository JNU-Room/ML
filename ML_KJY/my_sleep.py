from pylib.Softmax import Softmax

x_data = [[2., 1., 1. , 25., 7.],
          [2, 1., 1., 22., 2.],
          [4., 1., 1., 22., 2.],
          [2., 1., 1., 22., 7.],
          [2., 1., 2., 23., 8.],
          [2., 1., 1., 24, 8.],
          [2., 1., 1., 26, 4.5],
          [2., 1., 2., 24, 5],
          [2., 3., 1., 23., 4.5],
          [2., 1., 1., 23., 7.],
          [2., 1., 1., 24., 7.5],
          [2., 1., 1., 23., 7.],
          [2., 1., 1., 22., 8.],
          [2., 1., 1., 23., 3.],
          [3., 1., 1., 8., 0.],
          [3., 1., 1., 27., 4.],
          [3., 1., 1., 27., 5.],
          [3., 1., 1., 24., 3.],
          [2., 1., 1., 24., 4.],
          [2., 1., 1., 23., 6.],
          [2., 1., 2., 28., 6.5],
          [3., 1., 1., 24., 8.],
          [2., 1., 1., 23., 7.],
          [2., 1., 1., 26., 8.],
          [2., 1., 1., 22., 6.],
          [2., 1., 1., 23., 11.],
          [2., 1., 1., 28., 6.],
          [2., 1., 1., 26., 7.],
          [2., 1., 1., 25., 5.],
          [2., 1., 1., 24., 7.],
          [3., 2., 1., 22., 6.]
         ]
            #연령 직업 성별 잠에 잔, 시간, 전날 잔 시간
            #1 학생 2 it직종 3 운전기사
y_data = [[0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
          [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
          [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
          [0, 0, 0, 0, 0, 1, 0, 0, 0, 0 ,0],
          [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
          [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
          [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
          [0, 0, 0, 0, 0, 1, 0 ,0 ,0, 0, 0],
          [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
          [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
          [0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0],
          [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
          [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
          [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
          [0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
          [0 ,0 ,0 ,0 ,1, 0, 0, 0, 0, 0, 0],
          [0 ,0 ,0 ,0 ,1, 0, 0, 0, 0, 0, 0],
          [0 ,0 ,0 ,0 ,0, 0, 0, 1, 0, 0, 0],
          [0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
          [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
          [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
          [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
          [0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
          [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
          [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
          [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
          [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
          [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
          [0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
          [0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
          [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]# 컷
          ]# 3~14시간 자게될 확률
        #11페이지까지 조사 완료

prd_time = 0
Softmax = Softmax(x_data,y_data)


# Softmax.training(learning_rate=0.02,step = 200001,show_training_data=True)
# Softmax.save_weight()
Softmax.load_weight()
print(Softmax.W)
print(Softmax.b)
Softmax.predict([[2, 1., 1., 24., 7]])
print(Softmax.return_predict_possibility())
for i , w in enumerate(Softmax.return_predict_possibility()[0]):
    prd_time += (i + 5) * w
print(prd_time)
